<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Committee - Cortex Club</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <h1>Cortex<span class="brand-accent">Club</span></h1>
            </div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="events.html">Events</a></li>
                <li><a href="news.html">News</a></li>
                <li><a href="committee.html">Committee</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <section id="committee" class="section" style="margin-top: 70px;">
        <div class="container">
            <h2 class="section-title">Committee</h2>
            <div class="committee-grid" id="committeeGrid"></div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Cortex Club, University of Oxford. All rights reserved.</p>
        </div>
    </footer>

    <script src="../utils/script.js"></script>
    <script>
        let allCommittees = [];

        // Load all committee JSON files dynamically
        async function loadCommittees() {
            try {
                // First, load the index.json to get list of all committee files
                const indexResponse = await fetch('../committees/index.json');
                const indexData = await indexResponse.json();
                
                // Load all committee files listed in index.json
                const promises = indexData.committees.map(filename => 
                    fetch(`../committees/${filename}`)
                        .then(response => response.json())
                        .catch(error => console.error(`Failed to load ${filename}:`, error))
                );

                const results = await Promise.all(promises);
                allCommittees = results.filter(committee => committee !== undefined);
                console.log('Loaded committees:', allCommittees);
                renderCommittees();
            } catch (error) {
                console.error('Failed to load committees index:', error);
            }
        }

        function renderCommittees() {
            const grid = document.getElementById('committeeGrid');
            if (!grid) return;

            grid.innerHTML = '';

            allCommittees.forEach(committee => {
                const card = document.createElement('div');
                card.className = 'committee-card';
                
                card.innerHTML = `
                    <img src="../assets/committee_photos/${committee.photo}" alt="${committee.name}" class="committee-portrait">
                    <div class="committee-info">
                        <h3>[${committee.role}]</h3>
                        <p class="committee-name">${committee.name}</p>
                        <p class="committee-bio">${committee.bio}</p>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Load committees when page loads
        loadCommittees();
    </script>
</body>
</html>
